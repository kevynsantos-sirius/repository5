<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8" />
<title>PADD - Meus Documentos</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">

<link rel="stylesheet" th:href="@{/css/identificacao.css}" />
<link rel="stylesheet" th:href="@{/css/ti.css}" />
<link rel="stylesheet" href="/css/style.css" />

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>

<link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
<script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>

<link rel="stylesheet" th:href="@{/css/notiflix/notiflix-3.2.7.min.css}">
<script src="/js/notiflix/notiflix-loading-aio-3.2.7.min.js"></script>

</head>

<body>
<div class="main-wrapper">
    <!-- SIDEBAR -->
    <aside class="sidebar">
        <div class="sidebar-header d-flex align-items-center mb-4">
    		<a th:href="@{/}" class="text-decoration-none">
        		<img src="/images/PADD.png" height="100" width="170"/>
    		</a>
		</div>

        <!-- BOTÃO NOVO DOCUMENTO -->
        <button id="btnNovo" class="btn btn-novo active" onclick="NovoDocumento()">Novo documento</button>
    </aside>

    <!-- CONTEÚDO PRINCIPAL -->
    <main class="content-area container-fluid">
    
    	 <!-- Rodapé fixo com usuário + sair -->
			<div class="sidebar-user-footer d-flex align-items-center justify-content-end gap-2">
				<div class="sidebar-user-internal">
				    <!-- Avatar com inicial -->
				    <div class="avatar-circle">
				        <span th:text="${#strings.substring(usuarioLogado.nome, 0, 1)}"></span>
				    </div>
				
				    <div class="flex-grow-1">
				        <!-- Nome do usuário -->
				        <span class="nome-usuario"
				              th:text="${usuarioLogado.nome}">
				            Usuário
				        </span>
				
				        <!-- Botão sair -->
				        <form th:action="@{/logout}" method="post" class="mt-1">
				            <button class="btn btn-sm btn-logout w-100 text-start">
				                Sair
				            </button>
				        </form>
				    </div>
				</div>
			
			</div>	
    	<!-- SUBMENU DAS ABAS -->
	    <!-- TOPO DO CONTEÚDO -->
		<div class="content-header">
  
		  <!-- Submenu -->
		  <div id="submenu" class="submenu-top collapse">
		    <button class="submenu-item active"
		            onclick="mostrarAba('aba-identificacao', this)">
		      Identificação do Documento
		    </button>
		
		    <button class="submenu-item"
		            onclick="mostrarAba('aba-ti', this)">
		      Layout e Forma de Envio
		    </button>
		
		    <button class="submenu-item"
		            onclick="mostrarAba('aba-modelo', this)">
		      Modelo
		    </button>
		  </div>
		
		  <!-- Botão versões -->
		  <button class="btn btn-outline-primary btn-versoes collapse"
		          id="btnCarregarVersoes"
		          type="button"
		          data-bs-toggle="offcanvas"
		          data-bs-target="#staticBackdrop">
		    ☰ Versões
		  </button>
		
		</div>

        <!-- ABA: HOME (padrão) -->
        <div id="aba-home" class="aba" style="display:block;">		
            <div class="card documentos-card mt-2">
                <div class="card-header d-flex justify-content-between align-items-center bg-white border-0 pb-0">
                    <h5 class="mb-0">Meus documentos</h5>
                    <button class="btn btn-recarregar" onclick="location.reload()">Recarregar</button>
              
                </div>

                <div class="card-body pt-3">
                    <div th:replace="fragment/checklists :: tabelaChecklist(${checklists})"></div>

                    <div class="footer-btns mt-4">
                        <button class="btn btn-status">Em revisão</button>
                        <button class="btn btn-status">Aprovado</button>
                        <button class="btn btn-status">Publicado</button>
                    </div>
                </div>

            </div>
        </div>

        <!-- ABA: IDENTIFICAÇÃO -->
        <div id="aba-identificacao" class="aba" style="display:none;">
            <div th:replace="~{fragment/identificacao :: identificacao}"></div>
        </div>

        <!-- ABA: TI -->
        <div id="aba-ti" class="aba" style="display:none;">
            <div th:replace="~{fragment/ti :: ti}"></div>
        </div>
        
        <!-- ABA: Modelo -->
        <div id="aba-modelo" class="aba" style="display:none;">
            <div th:replace="~{fragment/modelo :: modelo}"></div>
        </div>
        
        <div id="acoesChecklist" class="d-flex justify-content-end gap-2 mt-2">
		    <!-- Cancelar -->
		    <button id="btnCancelar"
		            type="button"
		            class="btn-acoes btn-cancelar d-none"
		            onclick="cancelarCriacaoChecklist()">
		        Cancelar
		    </button>
		
		    <!-- Salvar -->
		    <button id="btnSalvar"
			        type="button"
			        class="btn-acoes btn-salvar d-none">
			    Salvar Documento
			</button>
		</div>
    </main>
    
     <!-- LISTA -->
    <div class="offcanvas offcanvas-end" data-bs-backdrop="static" tabindex="-1" id="staticBackdrop" aria-labelledby="staticBackdropLabel">
  <div class="offcanvas-header">
    <h5 class="offcanvas-title" id="staticBackdropLabel">Versões Checklist</h5>
    <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
  </div>
  <div class="offcanvas-body">
    <div>
      <ul id="listaVersoesLateral" class="lista-versoes">
        <!-- JS preenche -->
    </ul>
    </div>
  </div>
</div>
    

<!-- </aside> -->
	
</div>

<script>
    window.USUARIO_LOGADO_ID   = '[[${usuarioLogado.id}]]';
    window.USUARIO_LOGADO_NOME = '[[${usuarioLogado.nome}]]';
</script>


<script th:inline="javascript">
    window.API_BASE_URL = /*[[${apiUrl}]]*/ "";
</script>


<script src="/js/identificacao.js"></script>
<script src="/js/ti.js"></script>
<script src="/js/app.js"></script>

</body>
</html>
